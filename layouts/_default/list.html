{{ define "main" }}
<div class="container">
    <div style="margin-bottom: 40px; text-align: center; padding-top: 20px;">
        <h1 style="font-size: 2.5rem; margin-bottom: 10px;">{{ .Title }}</h1>
        {{ if .Description }}<p style="color: var(--text-light); max-width: 700px; margin: 0 auto;">{{ .Description }}
        </p>{{ end }}
    </div>

    <!-- Advanced & Filters -->
    {{ partial "advanced-filters.html" . }}

    <div class="card-grid" id="contentGrid">
        {{ $paginator := .Paginate (.Pages.ByWeight) }}
        {{ range $paginator.Pages }}
        <article class="card" data-title="{{ .Title | lower }}" data-city="{{ .Params.province | lower }}"
            data-district="{{ .Params.district | lower }}" data-type="{{ .Params.type | lower }}">
            <a href="{{ .RelPermalink }}" class="card-img-wrap">
                {{ $img := .Params.image | default .Params.featured_image | default .Params.cover }}
                {{ if $img }}
                {{ $thumb := $img }}
                {{ if and (findRE "wikimedia.org" $img) (findRE "/commons/" $img) }}
                {{ $thumb = replace $img "/commons/" "/commons/thumb/" }}
                {{ $fileName := index (last 1 (split $img "/")) 0 }}
                {{ $thumb = printf "%s/800px-%s" $thumb $fileName }}
                {{ if eq (path.Ext $img) ".svg" }}{{ $thumb = $img }}{{ end }}
                {{ end }}
                <img src="{{ $thumb }}" alt="{{ .Title }}" class="card-img" loading="lazy" width="800" height="533"
                    style="aspect-ratio: 3/2; object-fit: cover;">
                {{ else }}
                <div
                    style="width: 100%; height: 100%; background: #eee; display: flex; align-items: center; justify-content: center; color: #ccc;">
                    G√∂rsel Yok</div>
                {{ end }}
            </a>
            <div class="card-content">
                <div class="card-meta">
                    <span>üìç {{ .Params.province }}</span>
                    <span class="badge">{{ .Params.type }}</span>
                </div>
                <h2 class="card-title"><a href="{{ .RelPermalink }}">{{ .Title }}</a></h2>
                <p class="card-excerpt">
                    {{ .Summary | plainify | truncate 120 }}
                </p>
                <a href="{{ .RelPermalink }}" class="card-cta">ƒ∞ncele ‚Üí</a>
            </div>
        </article>
        {{ end }}
    </div>

    <!-- Pagination -->
    {{ template "_internal/pagination.html" . }}
</div>

<script>
    function filterContent() {
        var input, filter, grid, cards, title, province, type, i;
        input = document.getElementById('contentSearch');
        filter = input.value.toLocaleLowerCase('tr-TR');
        grid = document.getElementById('contentGrid');
        cards = grid.getElementsByClassName('card');

        for (i = 0; i < cards.length; i++) {
            title = cards[i].getAttribute('data-title');
            province = cards[i].getAttribute('data-province');
            type = cards[i].getAttribute('data-type');

            if (title.indexOf(filter) > -1 || province.indexOf(filter) > -1 || type.indexOf(filter) > -1) {
                cards[i].style.display = "flex";
            } else {
                cards[i].style.display = "none";
            }
        }
    }
</script>
{{ end }}